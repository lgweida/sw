# Routing table lookup dictionary
routing_table = {
    'ARTISANMZHO': [
        {'CURRENCY': '*', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': 'SI', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'USD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'FlexTradeBuySide42'},
        {'CURRENCY': 'CAD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'FlexTradeBuySide42'},
        {'CURRENCY': 'AUD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'CNH', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'CNY', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'HKD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'IDR', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'INR', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'JPY', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'KRW', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'MYR', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'NZD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'PHP', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'SGD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'THB', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'TWD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
    ],
    'PRIMECAP': [
        {'CURRENCY': 'USD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'FlexTradeBuySide42'},
        {'CURRENCY': 'CAD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'FlexTradeBuySide42'},
    ],
    'OSTERS': [
        {'CURRENCY': '*', 'TARGETSUBID': 'PT', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'O_FLEXTRADE_GLOBAL_PT_FIX42'},
    ],
    'THORNTREE': [
        {'CURRENCY': '*', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': 'SI', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'USD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'FlexTradeBuySide42'},
        {'CURRENCY': 'CAD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'FlexTradeBuySide42'},
        {'CURRENCY': 'AUD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'CNH', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'CNY', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'HKD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'IDR', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'INR', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'JPY', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'KRW', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'MYR', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'NZD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'PHP', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'SGD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'THB', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
        {'CURRENCY': 'TWD', 'TARGETSUBID': '*', 'DELIVERTTOSUBID': '*', 'FIX.5847': '*', 'ETF': '*', 'COUNTRYCODE': '*', 'DESTINATION': 'MizuhoTKGOR42BuySide'},
    ]
}


def get_routes(key):
    """
    Returns currency-to-destination routes for a given ONBEHALFOFCOMPTID key.
    Combines currencies with the same destination together.
    Format: "CURRENCY=XXX,YYY,ZZZ -> DESTINATION" or with special conditions if applicable.
    
    Args:
        key (str): The ONBEHALFOFCOMPTID to lookup
        
    Returns:
        list: List of route strings, or None if key not found
    """
    routes = routing_table.get(key)
    if not routes:
        return None
    
    # Group routes by destination and conditions
    route_groups = {}
    for route in routes:
        # Check for non-wildcard conditions
        conditions = []
        for field in ['TARGETSUBID', 'DELIVERTTOSUBID', 'FIX.5847', 'ETF', 'COUNTRYCODE']:
            if route.get(field) and route[field] != '*':
                conditions.append(f"{field}={route[field]}")
        
        # Create a key for grouping
        if conditions:
            group_key = (route['DESTINATION'], ', '.join(conditions))
        else:
            group_key = (route['DESTINATION'], None)
        
        # Add currency to the group
        if group_key not in route_groups:
            route_groups[group_key] = []
        route_groups[group_key].append(route['CURRENCY'])
    
    # Build the route strings
    route_strings = []
    for (destination, conditions), currencies in route_groups.items():
        if conditions:
            route_str = f"{conditions} -> {destination}"
        else:
            currency_list = ','.join(currencies)
            route_str = f"CURRENCY={currency_list} -> {destination}"
        
        route_strings.append(route_str)
    
    return route_strings


# Example usage
if __name__ == "__main__":
    # Test the function
    print("Routes for ARTISANMZHO:")
    routes = get_routes('ARTISANMZHO')
    if routes:
        for route in routes:
            print(f"  {route}")
    
    print("\nRoutes for OSTERS:")
    routes = get_routes('OSTERS')
    if routes:
        for route in routes:
            print(f"  {route}")
